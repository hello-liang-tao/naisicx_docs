23.Arduino 下雨关窗
===================================

设计要求
----------------------------------

使用Arduino Nano开发板设计一套实现具有下雨自动关闭窗户的功能的装置,使用舵机模拟关窗动作,使用雨滴传感器检测雨滴。

使用材料
------------------------------------

- Arduino Nano开发板
- SG90 舵机
- 雨滴传感器
- 杜邦线若干
- 其他


模块介绍
------------------------------------

雨滴传感器
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

雨滴传感器可以检测下雨雨滴,如下图接触面的电极交叉排布,当雨滴落在两个交叉电极之间时就会形成 ``电阻``,雨滴越多电阻越小。 ``雨滴传感器可以检测是否下雨以及雨量大小`` 。雨滴接触面板的两个电极端接到 ``电压比较器`` 的输入端，通过调节电阻可以配置触发是否检测到雨滴的阈值,信号的输出也有两种方式。

- 模拟信号输出:雨量以模拟量(AO)电压的形式输出，处理器根据电压大小判断是否有雨滴以及雨量大小。
- 数字信号输出:只能输出是否有雨开关量(DO),不能判断雨量大小,当然通过调节电阻可以调节是否有雨阈值。

当接上3.3V到5V电源,电源指示灯亮,感应板上没有水滴时,DO输出为高电平,开关指示灯灭, ``滴上一滴水,DO输出为低电平,开关指示灯亮,刷掉上面的水滴,又恢复到DO输出高电平状态`` ,阈值可调节。AO模拟输出,可以连接单片机的AD口检测是否有雨滴以及滴在上面的雨量大小。 


.. figure:: ../media/雨滴传感器.png
   :alt: 雨滴传感器
   :align: center

-------------------------------------

SG90舵机
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

``舵机是一种常用的伺服电机``,可以按照需要旋转不同角度。SG90舵机工作电压是4.8V,旋转速度0.3秒/60度, :guilabel:`红色-5V、橙色-PWM(D9)、棕色-GND`。

.. figure:: ../media/SG90舵机.png
   :alt: SG90舵机
   :align: center

----------------------------------

PWM舵机是通过可变的脉冲来控制的,控制线接到PWM管脚, ``舵机的PWM信号周期是20ms,占空比范围是0.5-2.5ms,1.5ms即为中位信号``。

========  ========
时间        角度  
========  ========
0.5ms       0° 
1.0ms       45°
1.5ms       90°   
2.0ms       135°  
2.5ms       180°  
========  ========


.. note::
   舵机是精密的产品,请勿大力扭动舵机旋转摆臂。大力扭动舵机旋转摆臂可能会对舵机产生不可逆的损坏。同时也不要在舵机上电或工作状态下拆装舵机。

PWM脉冲
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

``​脉冲宽度调制(PWM),是英文“Pulse Width Modulation”`` 的缩写,简称脉宽调制,是一种广泛使用的控制信号。 

``PWM 频率:`` 是指1秒钟内信号从高电平到低电平再回到高电平(1个周期T)的次数,例如1秒钟5次这样的周期,则频率为5Hz。 

``PWM 周期:`` 周期T是频率f的倒数,例如1秒钟5Hz,则周期为200ms。 

``PWM 占空比:`` 一个脉冲周期内,高电平的时间与整个周期时间的比例。


实物连接
-----------------------------------


设计分析
-------------------------------------


程序源码
------------------------------------





